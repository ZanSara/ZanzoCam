<html>
<head>
  <title>ZANZOCAM - Impostazioni</title>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta content="text/html; charset=ISO-8859-1">
  <link href="milligram.css" rel="stylesheet">

</head>
<body class="sky">
	<div class="cloud x1"></div>
	<div class="cloud x2"></div>
	<div class="cloud x3"></div>
	<div class="cloud x4"></div>
	<div class="cloud x5"></div>
	<div class="cloud x6"></div>
	<div class="cloud x7"></div>
	<div class="cloud x11"></div>
	<div class="cloud x12"></div>
	<div class="cloud x13"></div>
	<div class="cloud x14"></div>
	<div class="cloud x15"></div>
	<div class="cloud x16"></div>
	<div class="cloud x17"></div>

<div id="container">
    
    <div class="center">
        <h2>Impostazioni</h2>
        <h1>ZANZOCAM</h1>
    </div>
    
    <div id="loading" class="center">
        <hr />
        <h2>Caricamento...</h2>
        <hr />
    </div>
    
    <div id="main-form" style="display:none;">
    
        <form id="config">
            <h3>Server:</h3>
                <label for="server_url">URL del server:</label>
                <input type="text" placeholder="https://example.com/foto"  name="server_url">
                
                <label for="server_username">Username del server (se necessario):</label>
                <input type="text" placeholder="username"  name="server_username">
                
                <label for="server_password">Password del server (se necessaria):</label>
                <input type="text" placeholder="password"  name="server_password">
                
            <hr />        
            <h3>Crontab:</h3>
            
                <div class="row">
                    <div class="column">
                        <label class="label-inline">Minuti:</label>
                        <input type="text" placeholder="*"  name="crontab__minute">
                    </div>
                    <div class="column">
                        <label class="label-inline">Ora:</label>
                        <input type="text" placeholder="*"  name="crontab__hour">
                    </div>
                    <div class="column">
                        <label class="label-inline">Giorno:</label>
                        <input type="text" placeholder="*"  name="crontab__day">
                    </div>
                    <div class="column">
                        <label class="label-inline">Mese:</label>
                        <input type="text" placeholder="*"  name="crontab__month">
                    </div>
                    <div class="column">
                        <label class="label-inline">G. settimana:</label>
                        <input type="text" placeholder="*"  name="crontab__weekday">
                    </div>
                </div>
            
            <hr />
            
     <!-------------------------------------------------------------------------->
        
            <h3>Foto:</h3>
                
                <div class="row">
                    <div class="column column-75">
                        <label for="image__name">Nome:</label>
                        <input type="text" placeholder="foto"  name="image__name">
                    </div>
                    <div class="column">
                        <label for="image__extension">Estensione:</label>
                        <select id="image__extension">
                          <option value="jpg">JPG</option>
                          <option value="png">PNG</option>
                          <option value="gif">GIF</option>
                        </select>
                    </div>
                </div>
                
                <input type="checkbox"  name="image__add_date_to_name">
                <label class="label-inline" for="image__add_date_to_name">Aggiungi la data al nome della foto</label>
                <br>
                
                <input type="checkbox"  name="image__add_time_to_name">
                <label class="label-inline" for="image__add_time_to_name">Aggiungi l'ora al nome della foto</label>
                <br>
                <br>
                
                <div class="row">
                    <div class="column">
                        <label for="image__width">Larghezza:</label>
                        <input type="text" placeholder="2592"  name="image__width">
                    </div>
                    <div class="column">
                        <label for="image__height">Altezza:</label>
                        <input type="text" placeholder="1944"  name="image__height">
                    </div>
                </div>
                
                <div class="row">
                    <div class="column">
                        <input type="checkbox"  name="image__hor_flip">
                        <label class="label-inline" for="image__hor_flip">Speccha in orizzontale</label>
                        <br>            
                        <br>
                    </div>
                    <div class="column">
                        <input type="checkbox"  name="image__ver_flip">
                        <label class="label-inline" for="image__ver_flip">Specchia in verticale</label>
                        <br>
                        <br>
                    </div>
                </div>
                        
                <div class="row">
                    <div class="column">
                        <label for="image__rotation">Angolo Rotazione:</label>
                        <input type="text" placeholder="0"  name="image__rotation">
                    </div>
                    <div class="column">
                        <label for="image__background_color">Colore Sfondo (RGBA):</label>
                        <input type="text" placeholder="#00000000"  name="image__background_color">
                    </div>
                </div>
                
                <label>Se JPEG:</label>
                <div class="row">
                    <div class="column">
                        <label class="label-inline">Qualita':</label>
                        <input type="text" placeholder="90"  name="image__jpeg_quality">
                    </div>
                    <div class="column">
                        <label class="label-inline">Subsampling:</label>
                        <input type="text" placeholder="0"  name="image__jpeg_subsampling">
                    </div>
                </div>
                
                <hr />        
                <h3>Testo e Immagini:</h3>

     <!-------------------------------------------------------------------------->

                <h4>In alto a destra</h4>
                <div class="row">
                    <div class="column">
                        <input type="radio" value="" name="overlays__top_right__type" checked onclick="javascript:toggle_type_of_overlay('top_right', 'neither')">
                        <label class="label-inline" for="top_right_empty">Niente</label><br>
                    </div>
                    <div class="column">
                        <input type="radio" value="text" name="overlays__top_right__type" onclick="javascript:toggle_type_of_overlay('top_right', 'text')">
                        <label class="label-inline" for="top_right_text">Testo</label><br>
                    </div>
                    <div class="column">    
                        <input type="radio" value="image" name="overlays__top_right__type" onclick="javascript:toggle_type_of_overlay('top_right', 'image')">
                        <label class="label-inline" for="female">Immagine</label><br>
                    </div>
                </div> 
                
                <input type="hidden"  name="overlays__top_right__over_the_picture" value="off">

                <div id="top_right_text-vars" style="display: none;">
                    <label for="overlays__top_right__text">Testo</label>
                    <textarea placeholder="Testo..." name="overlays__top_right__text"></textarea>
                    
                    
                    <div class="row">
                        <div class="column">
                            <label for="overlays__top_right__font_color">Colore Testo (RGBA):</label>
                            <input type="text" placeholder="#FFFFFFFF"  name="overlays__top_right__font_color">
                        </div>
                        <div class="column">
                            <label for="overlays__top_right__background_color">Colore Sfondo (RGBA):</label>
                            <input type="text" placeholder="#00000000"  name="overlays__top_right__background_color">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Dimensione del font:</label>
                            <input type="text" placeholder="30"  name="overlays__top_right__font_size">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__top_right__over_the_picture">
                            <label class="label-inline" for="overlays__top_right__over_the_picture">Dentro il perimetro della foto</label>
                            <br> 
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Formato Data (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%d %B %Y"  name="overlays__top_right__date_format">
                        </div>
                        <div class="column">
                            <label>Formato Ora (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%H:%M"  name="overlays__top_right__time_format">
                        </div>
                    </div>
                </div>                
     
                <div id="top_right_image-vars" style="display: none;">
                    <div class="row">
                        <div class="column">
                            <label>Immagine Attuale:</label>
                            <img id="overlays__top_right__height" height="200"></img>
                        </div>
                        <div class="column vertical-center">
                            <label>Cambia immagine</label>
                            <input type="file" name="overlays__top_right__image">
                        </div>
                    </div>
                       
                    <div class="row">
                        <div class="column">
                            <label>Larghezza:</label>
                            <input type="text" placeholder="100"  name="overlays__top_right__width">
                        </div>
                        <div class="column">
                            <label>Altezza:</label>
                            <input type="text" placeholder="100"  name="overlays__top_right__height">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Margine (% dim. immagine):</label>
                            <input type="text" placeholder="20"  name="overlays__top_right__padding_ratio">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__top_right__over_the_picture">
                            <label class="label-inline" for="overlays__top_right__over_the_picture">Dentro il perimetro della foto</label>
                            <br>                    
                        </div>
                    </div>
                </div>
                
     <!-------------------------------------------------------------------------->
                
                <br>
                <h4>In alto al centro</h4>
                <div class="row">
                    <div class="column">
                        <input type="radio"  value="" name="overlays__top_center__type" checked onclick="javascript:toggle_type_of_overlay('top_center', 'neither')">
                        <label class="label-inline" for="top_center_empty">Niente</label><br>
                    </div>
                    <div class="column">
                        <input type="radio"  value="text" name="overlays__top_center__type" onclick="javascript:toggle_type_of_overlay('top_center', 'text')">
                        <label class="label-inline" for="top_center_text">Testo</label><br>
                    </div>
                    <div class="column">    
                        <input type="radio"  value="image" name="overlays__top_center__type" onclick="javascript:toggle_type_of_overlay('top_center', 'image')">
                        <label class="label-inline" for="female">Immagine</label><br>
                    </div>
                </div>  
                
                <input type="hidden"  name="overlays__top_center__over_the_picture" value="off">

                <div id="top_center_text-vars" style="display: none;">
                    <label for="top_center_text-content">Testo</label>
                    <textarea placeholder="Testo..." name="overlays__top_center__text"></textarea>
                    
                     <div class="row">
                        <div class="column">
                            <label for="overlays__top_center__font_color">Colore Testo (RGBA):</label>
                            <input type="text" placeholder="#FFFFFFFF"  name="overlays__top_center__font_color">
                        </div>
                        <div class="column">
                            <label for="overlays__top_center__background_color">Colore Sfondo (RGBA):</label>
                            <input type="text" placeholder="#00000000"  name="overlays__top_center__background_color">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Dimensione del font:</label>
                            <input type="text" placeholder="30"  name="overlays__top_center__font_size">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__top_center__over_the_picture">
                            <label class="label-inline" for="overlays__top_center__over_the_picture">Dentro il perimetro della foto</label>
                            <br> 
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Formato Data (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%d %B %Y"  name="overlays__top_center__date_format">
                        </div>
                        <div class="column">
                            <label>Formato Ora (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%H:%M"  name="overlays__top_center__time_format">
                        </div>
                    </div>
                </div>                
     
                <div id="top_center_image-vars" style="display: none;">
                    <div class="column">
                        <label>Immagine Attuale:</label>
                        <img id="overlays__top_center__image" height="200"></img>
                    </div>
                    <div class="column vertical-center">
                        <label>Cambia immagine</label>
                        <input type="file" name="overlays__top_center__image">
                    </div>
                        
                    <div class="row">
                        <div class="column">
                            <label>Larghezza:</label>
                            <input type="text" placeholder="100"  name="overlays__top_center__width">
                        </div>
                        <div class="column">
                            <label>Altezza:</label>
                            <input type="text" placeholder="100"  name="overlays__top_center__height">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Margine (% dim. immagine):</label>
                            <input type="text" placeholder="20"  name="overlays__top_center__padding_ratio">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__top_center__over_the_picture">
                            <label class="label-inline" for="overlays__top_center__over_the_picture">Dentro il perimetro della foto</label>
                            <br>                    
                        </div>
                    </div>
                </div>

     <!-------------------------------------------------------------------------->
                
                <br>
                <h4>In alto a sinistra</h4>
                <div class="row">
                    <div class="column">
                        <input type="radio" value="" name="overlays__top_left__type" checked onclick="javascript:toggle_type_of_overlay('top_left', 'neither')">
                        <label class="label-inline" for="top_left_empty">Niente</label><br>
                    </div>
                    <div class="column">
                        <input type="radio" value="text" name="overlays__top_left__type" onclick="javascript:toggle_type_of_overlay('top_left', 'text')">
                        <label class="label-inline" for="top_left_text">Testo</label><br>
                    </div>
                    <div class="column">    
                        <input type="radio" value="image" name="overlays__top_left__type" onclick="javascript:toggle_type_of_overlay('top_left', 'image')">
                        <label class="label-inline" for="female">Immagine</label><br>
                    </div>
                </div>  

                <input type="hidden"  name="overlays__top_left__over_the_picture" value="off">

                <div id="top_left_text-vars" style="display: none;">
                    <label for="top_left_text-content">Testo</label>
                    <textarea placeholder="Testo..." name="overlays__top_left__text"></textarea>
                    
                     <div class="row">
                        <div class="column">
                            <label for="overlays__top_left__font_color">Colore Testo (RGBA):</label>
                            <input type="text" placeholder="#FFFFFFFF"  name="overlays__top_left__font_color">
                        </div>
                        <div class="column">
                            <label for="overlays__top_left__background_color">Colore Sfondo (RGBA):</label>
                            <input type="text" placeholder="#00000000"  name="overlays__top_left__background_color">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Dimensione del font:</label>
                            <input type="text" placeholder="30"  name="overlays__top_left__font_size">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__top_left__over_the_picture">
                            <label class="label-inline" for="overlays__top_left__over_the_picture">Dentro il perimetro della foto</label>
                            <br> 
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Formato Data (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%d %B %Y"  name="overlays__top_left__date_format">
                        </div>
                        <div class="column">
                            <label>Formato Ora (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%H:%M"  name="overlays__top_left__time_format">
                        </div>
                    </div>
                </div>                
     
                <div id="top_left_image-vars" style="display: none;">
                    <div class="column">
                        <label>Immagine Attuale:</label>
                        <img id="overlays__top_left__image" height="200"></img>
                    </div>
                    <div class="column vertical-center">
                        <label>Cambia immagine</label>
                        <input type="file" name="overlays__top_left__image">
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Larghezza:</label>
                            <input type="text" placeholder="100"  name="overlays__top_left__width">
                        </div>
                        <div class="column">
                            <label>Altezza:</label>
                            <input type="text" placeholder="100"  name="overlays__top_left__height">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Margine (% dim. immagine):</label>
                            <input type="text" placeholder="20"  name="overlays__top_left__padding_ratio">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__top_left__over_the_picture">
                            <label class="label-inline" for="overlays__top_left__over_the_picture">Dentro il perimetro della foto</label>
                            <br>                    
                        </div>
                    </div>
                </div>

     <!-------------------------------------------------------------------------->
                
                <br>
                <h4>In basso a destra</h4>
                <div class="row">
                    <div class="column">
                        <input type="radio" value="" name="overlays__bottom_right__type" checked onclick="javascript:toggle_type_of_overlay('bottom_right', 'neither')">
                        <label class="label-inline" for="bottom_right_empty">Niente</label><br>
                    </div>
                    <div class="column">
                        <input type="radio" value="text" name="overlays__bottom_right__type" onclick="javascript:toggle_type_of_overlay('bottom_right', 'text')">
                        <label class="label-inline" for="bottom_right_text">Testo</label><br>
                    </div>
                    <div class="column">    
                        <input type="radio" value="image" name="overlays__bottom_right__type" onclick="javascript:toggle_type_of_overlay('bottom_right', 'image')">
                        <label class="label-inline" for="female">Immagine</label><br>
                    </div>
                </div>  

                <input type="hidden"  name="overlays__bottom_right__over_the_picture" value="off">

                <div id="bottom_right_text-vars" style="display: none;">
                    <label for="bottom_right_text-content">Testo</label>
                    <textarea placeholder="Testo..." name="overlays__bottom_right__text"></textarea>
                    
                    <div class="row">
                        <div class="column">
                            <label for="overlays__bottom_right__font_color">Colore Testo (RGBA):</label>
                            <input type="text" placeholder="#FFFFFFFF"  name="overlays__bottom_right__font_color">
                        </div>
                        <div class="column">
                            <label for="overlays__bottom_right__background_color">Colore Sfondo (RGBA):</label>
                            <input type="text" placeholder="#00000000"  name="overlays__bottom_right__background_color">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Dimensione del font:</label>
                            <input type="text" placeholder="30"  name="overlays__bottom_right__font_size">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__bottom_right__over_the_picture">
                            <label class="label-inline" for="overlays__bottom_right__over_the_picture">Dentro il perimetro della foto</label>
                            <br> 
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Formato Data (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%d %B %Y"  name="overlays__bottom_right__date_format">
                        </div>
                        <div class="column">
                            <label>Formato Ora (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%H:%M"  name="overlays__bottom_right__time_format">
                        </div>
                    </div>
                </div>                
     
                <div id="bottom_right_image-vars" style="display: none;">
                    <div class="column">
                        <label>Immagine Attuale:</label>
                        <img id="overlays__bottom_right__image" height="200"></img>
                    </div>
                    <div class="column vertical-center">
                        <label>Cambia immagine</label>
                        <input type="file" name="overlays__bottom_right__image">
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Larghezza:</label>
                            <input type="text" placeholder="100"  name="overlays__bottom_right__width">
                        </div>
                        <div class="column">
                            <label>Altezza:</label>
                            <input type="text" placeholder="100"  name="overlays__bottom_right__height">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Margine (% dim. immagine):</label>
                            <input type="text" placeholder="20"  name="overlays__bottom_right__padding_ratio">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__bottom_right__over_the_picture">
                            <label class="label-inline" for="overlays__bottom_right__over_the_picture">Dentro il perimetro della foto</label>
                            <br>                    
                        </div>
                    </div>
                </div>  


     <!-------------------------------------------------------------------------->
                
                <br>
                <h4>In basso al centro</h4>
                <div class="row">
                    <div class="column">
                        <input type="radio" value="" name="overlays__bottom_center__type" checked onclick="javascript:toggle_type_of_overlay('bottom_center', 'neither')">
                        <label class="label-inline" for="bottom_center_empty">Niente</label><br>
                    </div>
                    <div class="column">
                        <input type="radio" value="text" name="overlays__bottom_center__type" onclick="javascript:toggle_type_of_overlay('bottom_center', 'text')">
                        <label class="label-inline" for="bottom_center_text">Testo</label><br>
                    </div>
                    <div class="column">    
                        <input type="radio" value="image" name="overlays__bottom_center__type" onclick="javascript:toggle_type_of_overlay('bottom_center', 'image')">
                        <label class="label-inline" for="female">Immagine</label><br>
                    </div>
                </div>
                
                <input type="hidden"  name="overlays__bottom_center__over_the_picture" value="off">

                <div id="bottom_center_text-vars" style="display: none;">
                    <label for="bottom_center_text-content">Testo</label>
                    <textarea placeholder="Testo..." name="overlays__bottom_center__text"></textarea>
                    
                     <div class="row">
                        <div class="column">
                            <label for="overlays__bottom_center__font_color">Colore Testo (RGBA):</label>
                            <input type="text" placeholder="#FFFFFFFF"  name="overlays__bottom_center__font_color">
                        </div>
                        <div class="column">
                            <label for="overlays__bottom_center__background_color">Colore Sfondo (RGBA):</label>
                            <input type="text" placeholder="#00000000"  name="overlays__bottom_center__background_color">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Dimensione del font:</label>
                            <input type="text" placeholder="30"  name="overlays__bottom_center__font_size">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__bottom_center__over_the_picture">
                            <label class="label-inline" for="overlays__bottom_center__over_the_picture">Dentro il perimetro della foto</label>
                            <br> 
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Formato Data (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%d %B %Y"  name="overlays__bottom_center__date_format">
                        </div>
                        <div class="column">
                            <label>Formato Ora (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%H:%M"  name="overlays__bottom_center__time_format">
                        </div>
                    </div>
                </div>                
     
                <div id="bottom_center_image-vars" style="display: none;">
                    <div class="column">
                        <label>Immagine Attuale:</label>
                        <img id="overlays__bottom_center__image" height="200"></img>
                    </div>
                    <div class="column vertical-center">
                        <label>Cambia immagine</label>
                        <input type="file" name="overlays__bottom_center__image">
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Larghezza:</label>
                            <input type="text" placeholder="100"  name="overlays__bottom_center__width">
                        </div>
                        <div class="column">
                            <label>Altezza:</label>
                            <input type="text" placeholder="100"  name="overlays__bottom_center__height">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Margine (% dim. immagine):</label>
                            <input type="text" placeholder="20"  name="overlays__bottom_center__padding_ratio">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__bottom_center__over_the_picture">
                            <label class="label-inline" for="overlays__bottom_center__over_the_picture">Dentro il perimetro della foto</label>
                            <br>                    
                        </div>
                    </div>
                </div> 

     <!-------------------------------------------------------------------------->
                
                <br>
                <h4>In basso a sinistra</h4>
                <div class="row">
                    <div class="column">
                        <input type="radio" value="" name="overlays__bottom_left__type" checked onclick="javascript:toggle_type_of_overlay('bottom_left', 'neither')">
                        <label class="label-inline" for="bottom_left_empty">Niente</label><br>
                    </div>
                    <div class="column">
                        <input type="radio" value="text" name="overlays__bottom_left__type" onclick="javascript:toggle_type_of_overlay('bottom_left', 'text')">
                        <label class="label-inline" for="bottom_left_text">Testo</label><br>
                    </div>
                    <div class="column">    
                        <input type="radio" value="image" name="overlays__bottom_left__type" onclick="javascript:toggle_type_of_overlay('bottom_left', 'image')">
                        <label class="label-inline" for="female">Immagine</label><br>
                    </div>
                </div>
                
                <input type="hidden"  name="overlays__bottom_left__over_the_picture" value="off">

                <div id="bottom_left_text-vars" style="display: none;">
                    <label for="bottom_left_text-content">Testo</label>
                    <textarea placeholder="Testo..." name="overlays__bottom_left__text"></textarea>
                    
                    <div class="row">
                        <div class="column">
                            <label for="overlays__bottom_left__font_color">Colore Testo (RGBA):</label>
                            <input type="text" placeholder="#FFFFFFFF"  name="overlays__bottom_left__font_color">
                        </div>
                        <div class="column">
                            <label for="overlays__bottom_left__background_color">Colore Sfondo (RGBA):</label>
                            <input type="text" placeholder="#00000000"  name="overlays__bottom_left__background_color">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Dimensione del font:</label>
                            <input type="text" placeholder="30"  name="overlays__bottom_left__font_size">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__bottom_left__over_the_picture">
                            <label class="label-inline" for="overlays__bottom_left__over_the_picture">Dentro il perimetro della foto</label>
                            <br> 
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Formato Data (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%d %B %Y"  name="overlays__bottom_left__date_format">
                        </div>
                        <div class="column">
                            <label>Formato Ora (<a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formato</a>):</label>
                            <input type="text" placeholder="%H:%M"  name="overlays__bottom_left__time_format">
                        </div>
                    </div>
                </div>                
     
                <div id="bottom_left_image-vars" style="display: none;">
                    <div class="column">
                        <label>Immagine Attuale:</label>
                        <img id="overlays__bottom_left__image" height="200"></img>
                    </div>
                    <div class="column vertical-center">
                        <label>Cambia immagine</label>
                        <input type="file" name="overlays__bottom_left__image">
                    </div>

                    <div class="row">
                        <div class="column">
                            <label>Larghezza:</label>
                            <input type="text" placeholder="100"  name="overlays__bottom_left__width">
                        </div>
                        <div class="column">
                            <label>Altezza:</label>
                            <input type="text" placeholder="100"  name="overlays__bottom_left__height">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="column">
                            <label>Margine (% dim. immagine):</label>
                            <input type="text" placeholder="20"  name="overlays__bottom_left__padding_ratio">
                        </div>
                        <div class="column">
                            <br>
                            <input type="checkbox"  name="overlays__bottom_left__over_the_picture">
                            <label class="label-inline" for="overlays__bottom_left__over_the_picture">Dentro il perimetro della foto</label>
                            <br>                    
                        </div>
                    </div>
                </div>  

     <!-------------------------------------------------------------------------->
             
                <hr />   

                <div class="center">
                    <input id="save" class="button-primary" type="submit" value="Salva" style="font-size:20pt;height:unset;padding:1rem 3rem;text-transform:none;">
                </div>     
        </form>
       
    </div>
</div>

<script>
    // Figures out the endpoint URL
    const url = window.location.href.substring(0, window.location.href.lastIndexOf("/")+1);
    var last_loaded_data = null;
    
    // Get JSON
    function loadData(){
        fetch(url, { method:'GET'})
        .then(response => response.json())
        .then(json => fillForm(json.configuration, ""));
    }   
    loadData(); 

    // Loads the JSON data into the form
    function fillForm(data, prefix){
        last_loaded_data = data;
	    document.getElementById("loading").style.display="none";  
	    document.getElementById("main-form").style.display="block"; 
	    
	    const { elements } = document.querySelector('form')
        
        for (const [ key, value ] of Object.entries(data) ) {
	        if (typeof value === 'object' & value !== null){
                fillForm(value, prefix+key+"__");
	        }
	        
            const field = elements.namedItem(prefix+key)
            if (field){
                if(field.type === "file"){
                    image = document.getElementById(prefix+key).src = url+ "config/images/" +value;  
                } else {
                    field.value = value
                }
            }
                                
	        if (typeof value === 'boolean'){
		        field.checked = value ? 'checked' : ''; 
	        }
	        
	        prefixes = prefix.split("__");
	        if (prefixes[0] == "overlays" &&  key == "type"){
	            toggle_type_of_overlay(prefixes[1], value);
	        }
        }
    }


    // Sets in a deep object from a flat key
	function deepSet(key, value, obj){
        var i;
	    key = key.split('__');
	    for (i = 0; i < key.length - 1; i++){
		    if (typeof obj[key[i]] === "undefined"){
		        obj[key[i]] = {};
            }
            obj = obj[key[i]];
	    }
	    obj[key[i]] = value;
	}
	
    // Gets in a deep object from a flat key
	function deepGet(key, obj){
        var i;
	    key = key.split('__');
	    for (i = 0; i < key.length - 1; i++){
		    if (typeof obj[key[i]] === "undefined"){
                obj[key[i]] = {};
		    }
            obj = obj[key[i]];        
        }
	    return obj[key[i]];
	}

    // Converts the form data back into JSON
    function formdata_to_json(formData){
        var object = {};
        formData.forEach((value, key) => {
        
            if (value===""){ value = null; }
            if (value==="on"){ value = true; }
            if (value==="off"){ value = false; }
            if (value===null && document.getElementsByName(key)[0].type === "file"){
                // This is a file that has not been changed.
                // Be sure to re-send the old value or it will clear the field.
                value = deepGet(key, last_loaded_data);
            }
	        if (value!==null){  // other null values are just noise
	            if (value instanceof File) {
                    value = value.name;
                } else {
                    value = value;
                }
                deepSet(key, value, object);
	        }
        });
        return object;
    }


    // Hooks on the Save button click event and sends the JSON to the endpoint
    const form = document.getElementById('config');
    form.onsubmit = async (e) => {
        e.preventDefault();

        const save = document.getElementById('save');
        save.disabled = true;        
        
        // Serialize the content of the form in a JSON file
        const data = new FormData(form);
        const object = formdata_to_json(data);
        serialized = JSON.stringify(object, null, "  ");
        
        // Create a new for with the JSON of the config and all the images
        formdata = new FormData();
        formdata.append("config", serialized);
        // Get all the images
        for(verr of ['top', 'bottom']) {
            for(hor of ['right', 'center', 'left']){
                var field = "overlays__"+verr+"_"+hor+"__image";
                if (data.has(field)){
                    formdata.append(field, data.get(field));
                }
            }
        }
	    // Display the key/value pairs
	    for (var pair of formdata.entries()) {
	        console.log(pair[0]+ ', ' + pair[1]); 
	    }        
            
	    fetch(url, {
            method:'POST',
            body: formdata,
        })
        .then(response => response.json())
        .then(reply => {
            console.log(reply);
            loadData();
        });
        
        save.disabled = false;  
    };
        
    
    // Toggle text or image config in the overlays section
    function toggle_type_of_overlay(position, value) {
        var text_block = document.getElementById(position+"_text-vars");
        var image_block = document.getElementById(position+"_image-vars");
        text_block.style.display = value==="text" ? "block" : "none";
        image_block.style.display = value==="image" ? "block" : "none";
    }
</script>

</body>
</html>
